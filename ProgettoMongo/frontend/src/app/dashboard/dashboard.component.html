<div class="app-container">
    <!-- Sidebar -->
    <aside class="sidebar">
        <div class="brand">
            <div class="logo-icon">ITS</div>
            <h1>Gestione Corsi</h1>
        </div>

        <nav class="nav-menu">
            <button (click)="setView('dashboard')" [class.active]="currentView === 'dashboard'" class="nav-item">
                <span class="icon">üìä</span> Dashboard
            </button>
            <button (click)="setView('moduli')" [class.active]="currentView === 'moduli'" class="nav-item">
                <span class="icon">üìö</span> Moduli
            </button>
            <button (click)="setView('studenti')" [class.active]="currentView === 'studenti'" class="nav-item">
                <span class="icon">üéì</span> Studenti
            </button>
        </nav>

        <div class="user-profile">
            <div class="avatar">A</div>
            <div class="user-info">
                <span class="name">Admin User</span>
                <span class="role">Amministratore</span>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">

        <!-- Dashboard View -->
        <div *ngIf="currentView === 'dashboard'" class="view-container fade-in">
            <header class="view-header">
                <h2>Panoramica</h2>
                <p class="subtitle">Benvenuto nel pannello di gestione ITS.</p>
            </header>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon purple">üìö</div>
                    <div class="stat-info">
                        <span class="label">Moduli Attivi</span>
                        <span class="value">{{ moduli.length }}</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon pink">üéì</div>
                    <div class="stat-info">
                        <span class="label">Studenti Iscritti</span>
                        <span class="value">{{ studenti.length }}</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon blue">üìù</div>
                    <div class="stat-info">
                        <span class="label">Esami Registrati</span>
                        <span class="value">{{ esami.length }}</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon green">‚≠ê</div>
                    <div class="stat-info">
                        <span class="label">Media Voti</span>
                        <span class="value">{{ mediaVoti }}</span>
                    </div>
                </div>
            </div>

            <div class="section-container">
                <h3>Attivit√† Recente</h3>
                <div class="table-card">
                    <table>
                        <thead>
                            <tr>
                                <th>Studente</th>
                                <th>Modulo</th>
                                <th>Voto</th>
                                <th>Data</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let esame of esami">
                                <td>{{ esame.studente }}</td>
                                <td>{{ esame.modulo }}</td>
                                <td>
                                    <span class="badge" [class.success]="esame.voto >= 24"
                                        [class.warning]="esame.voto < 24">
                                        {{ esame.voto }}
                                    </span>
                                </td>
                                <td>{{ esame.data }}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Moduli View -->
        <div *ngIf="currentView === 'moduli'" class="view-container fade-in">
            <header class="view-header">
                <h2>Moduli Formativi</h2>
                <button class="btn-primary" (click)="openModuloForm()">+ Nuovo Modulo</button>
            </header>

            <div class="grid-list">
                <div *ngFor="let modulo of moduli" class="item-card">
                    <div class="card-header">
                        <span class="code">{{ modulo.codice }}</span>
                        <span class="hours">{{ modulo.ore }} ore</span>
                    </div>
                    <h3>{{ modulo.nome }}</h3>
                    <p>{{ modulo.descrizione }}</p>
                </div>
            </div>
        </div>

        <!-- Modal for New Module -->
        <div *ngIf="showModuloForm" class="modal-overlay" (click)="closeModuloForm()">
            <div class="modal-card" (click)="$event.stopPropagation()">
                <div class="modal-header">
                    <h3>Nuovo Modulo</h3>
                    <button class="close-btn" (click)="closeModuloForm()">‚úï</button>
                </div>

                <form class="modal-form" (ngSubmit)="salvaModulo()">
                    <div class="form-group">
                        <label for="nome">Nome del Modulo</label>
                        <input type="text" id="nome" [(ngModel)]="nuovoModulo.nome" name="nome"
                            placeholder="Es. Sviluppo Web Avanzato" required>
                    </div>

                    <div class="form-group">
                        <label for="codice">Codice Identificativo</label>
                        <input type="text" id="codice" [(ngModel)]="nuovoModulo.codice" name="codice"
                            placeholder="Es. WEB01" required>
                    </div>

                    <div class="form-group">
                        <label for="ore">Ore Totali</label>
                        <input type="number" id="ore" [(ngModel)]="nuovoModulo.ore" name="ore" placeholder="Es. 80"
                            min="1" required>
                    </div>

                    <div class="form-group">
                        <label for="descrizione">Descrizione</label>
                        <textarea id="descrizione" [(ngModel)]="nuovoModulo.descrizione" name="descrizione"
                            placeholder="Descrizione del modulo..." rows="4"></textarea>
                    </div>

                    <div class="modal-actions">
                        <button type="button" class="btn-secondary" (click)="closeModuloForm()">Annulla</button>
                        <button type="submit" class="btn-primary">Salva Modulo</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Studenti View -->
        <div *ngIf="currentView === 'studenti'" class="view-container fade-in">
            <header class="view-header">
                <h2>Studenti</h2>
                <button class="btn-primary" (click)="openStudenteForm()">+ Nuovo Studente</button>
            </header>

            <div class="table-card">
                <table>
                    <thead>
                        <tr>
                            <th>Nome</th>
                            <th>Cognome</th>
                            <th>Email</th>
                            <th>Azioni</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let studente of studenti">
                            <td>{{ studente.nome }}</td>
                            <td>{{ studente.cognome }}</td>
                            <td>{{ studente.email }}</td>
                            <td>
                                <button class="btn-edit" (click)="modificaStudente(studente)">Modifica</button>
                                <button class="btn-delete" (click)="eliminaStudente(studente.id)">Elimina</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Modal for New Student -->
        <div *ngIf="showStudenteForm" class="modal-overlay" (click)="closeStudenteForm()">
            <div class="modal-card" (click)="$event.stopPropagation()">
                <div class="modal-header">
                    <h3>Nuovo Studente</h3>
                    <button class="close-btn" (click)="closeStudenteForm()">‚úï</button>
                </div>

                <form class="modal-form" (ngSubmit)="salvaStudente()">
                    <div class="form-group">
                        <label for="studenteNome">Nome</label>
                        <input type="text" id="studenteNome" [(ngModel)]="nuovoStudente.nome" name="studenteNome"
                            placeholder="Es. Mario" required>
                    </div>

                    <div class="form-group">
                        <label for="studenteCognome">Cognome</label>
                        <input type="text" id="studenteCognome" [(ngModel)]="nuovoStudente.cognome"
                            name="studenteCognome" placeholder="Es. Rossi" required>
                    </div>

                    <div class="form-group">
                        <label for="studenteEmail">Email</label>
                        <input type="email" id="studenteEmail" [(ngModel)]="nuovoStudente.email" name="studenteEmail"
                            placeholder="Es. mario.rossi@example.com" required>
                    </div>

                    <div class="modal-actions">
                        <button type="button" class="btn-secondary" (click)="closeStudenteForm()">Annulla</button>
                        <button type="submit" class="btn-primary">Salva Studente</button>
                    </div>
                </form>
            </div>
        </div>

    </main>
</div>